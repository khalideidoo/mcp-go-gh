// Code generated by tools/gen. DO NOT EDIT.
package generated

import (
	"context"
	"fmt"
	"github.com/khalideidoo/mcp-go-gh/internal/executor"
	"github.com/modelcontextprotocol/go-sdk/mcp"
)

// RulesetListArgs defines parameters for gh ruleset list
type RulesetListArgs struct {
	Limit   int    `json:"limit,omitempty" jsonschema:"description=Maximum number of rulesets to list"`
	Org     string `json:"org,omitempty" jsonschema:"description=List organization-wide rulesets for the provided organization"`
	Parents bool   `json:"parents,omitempty" jsonschema:"description=Whether to include rulesets configured at higher levels that also apply"`
	Web     bool   `json:"web,omitempty" jsonschema:"description=Open the list of rulesets in the web browser"`
	Repo    string `json:"repo,omitempty" jsonschema:"description=Select repository in OWNER/REPO format"`
}

// RegisterRulesetListTool registers the gh ruleset list tool
func RegisterRulesetListTool(server *mcp.Server, exec *executor.Executor) {
	mcp.AddTool(server, &mcp.Tool{
		Name:        "gh_ruleset_list",
		Description: "List GitHub rulesets for a repository or organization",
	}, func(ctx context.Context, req *mcp.CallToolRequest, args RulesetListArgs) (*mcp.CallToolResult, any, error) {
		cmd := []string{"ruleset", "list"}

		if args.Limit > 0 {
			cmd = append(cmd, "--limit", fmt.Sprintf("%d", args.Limit))
		}

		if args.Org != "" {
			cmd = append(cmd, "--org", args.Org)
		}

		if args.Parents {
			cmd = append(cmd, "--parents")
		}

		if args.Web {
			cmd = append(cmd, "--web")
		}

		if args.Repo != "" {
			cmd = append(cmd, "--repo", args.Repo)
		}

		result, err := exec.Execute(ctx, cmd...)
		if err != nil {
			return nil, nil, fmt.Errorf("gh ruleset list failed: %w", err)
		}

		return &mcp.CallToolResult{
			Content: []mcp.Content{
				&mcp.TextContent{Text: result.Stdout},
			},
		}, nil, nil
	})
}

// RulesetViewArgs defines parameters for gh ruleset view
type RulesetViewArgs struct {
	Org     string `json:"org,omitempty" jsonschema:"description=Organization name if the provided ID is an organization-level ruleset"`
	Parents bool   `json:"parents,omitempty" jsonschema:"description=Whether to include rulesets configured at higher levels that also apply"`
	Web     bool   `json:"web,omitempty" jsonschema:"description=Open the ruleset in the browser"`
	Repo    string `json:"repo,omitempty" jsonschema:"description=Select repository in OWNER/REPO format"`

	RulesetId string `json:"ruleset_id,omitempty" jsonschema:"description=Ruleset ID (positional argument)"`
}

// RegisterRulesetViewTool registers the gh ruleset view tool
func RegisterRulesetViewTool(server *mcp.Server, exec *executor.Executor) {
	mcp.AddTool(server, &mcp.Tool{
		Name:        "gh_ruleset_view",
		Description: "View information about a GitHub ruleset",
	}, func(ctx context.Context, req *mcp.CallToolRequest, args RulesetViewArgs) (*mcp.CallToolResult, any, error) {
		cmd := []string{"ruleset", "view"}

		// Add positional argument: ruleset_id
		if args.RulesetId != "" {
			cmd = append(cmd, args.RulesetId)
		}

		if args.Org != "" {
			cmd = append(cmd, "--org", args.Org)
		}

		if args.Parents {
			cmd = append(cmd, "--parents")
		}

		if args.Web {
			cmd = append(cmd, "--web")
		}

		if args.Repo != "" {
			cmd = append(cmd, "--repo", args.Repo)
		}

		result, err := exec.Execute(ctx, cmd...)
		if err != nil {
			return nil, nil, fmt.Errorf("gh ruleset view failed: %w", err)
		}

		return &mcp.CallToolResult{
			Content: []mcp.Content{
				&mcp.TextContent{Text: result.Stdout},
			},
		}, nil, nil
	})
}

// RulesetCheckArgs defines parameters for gh ruleset check
type RulesetCheckArgs struct {
	Default bool   `json:"default,omitempty" jsonschema:"description=Check rules on default branch"`
	Web     bool   `json:"web,omitempty" jsonschema:"description=Open the branch rules page in a web browser"`
	Repo    string `json:"repo,omitempty" jsonschema:"description=Select repository in OWNER/REPO format"`

	Branch string `json:"branch,omitempty" jsonschema:"description=Branch name to check (positional argument)"`
}

// RegisterRulesetCheckTool registers the gh ruleset check tool
func RegisterRulesetCheckTool(server *mcp.Server, exec *executor.Executor) {
	mcp.AddTool(server, &mcp.Tool{
		Name:        "gh_ruleset_check",
		Description: "View information about GitHub rules that apply to a given branch",
	}, func(ctx context.Context, req *mcp.CallToolRequest, args RulesetCheckArgs) (*mcp.CallToolResult, any, error) {
		cmd := []string{"ruleset", "check"}

		// Add positional argument: branch
		if args.Branch != "" {
			cmd = append(cmd, args.Branch)
		}

		if args.Default {
			cmd = append(cmd, "--default")
		}

		if args.Web {
			cmd = append(cmd, "--web")
		}

		if args.Repo != "" {
			cmd = append(cmd, "--repo", args.Repo)
		}

		result, err := exec.Execute(ctx, cmd...)
		if err != nil {
			return nil, nil, fmt.Errorf("gh ruleset check failed: %w", err)
		}

		return &mcp.CallToolResult{
			Content: []mcp.Content{
				&mcp.TextContent{Text: result.Stdout},
			},
		}, nil, nil
	})
}
